# Shape Dataset

Contains
- a Dataset of shapes for Machine Learning Classification.
- a Notebook to read the images and prepare data (ETL).
- a Notebook to do shape classification.

I have created this set of data for my app **[Mix on Pix](https://apps.apple.com/us/app/mix-on-pix-text-on-photos/id633281586)**.

The Dataset is in the directory: classify/data

### Images 
Images exists in 4 shapes
- Ellipse
- Rectangle
- Triangle
- Other

It contains images (70px x 70 px x 1 gray channel) separated in:
- Training set. 21393 images. Other: 5316, Ellipse: 5025, Rectangle: 5740, Triangle: 5312
- Validation Set. 3983 images. Other: 1130, Ellipse: 1069, Rectangle: 860, Triangle: 924
- Test set. 1923 images. Other: 841, Ellipse: 360, Rectangle: 359, Triangle: 363

Example of images from the Training set:
![examples](images/train_images.png)

### Data
#### People
Images were mostly generated by asking people I knew to draw Ellipses, Rectangles and Triangles in [Mix on Pix](https://apps.apple.com/us/app/mix-on-pix-text-on-photos/id633281586).  
People were aged from 7 to 87. I ask to draw the way they wanted, slow or fast. In Particular, I did not ask to draw nice shape. It was the intent while drawing that interested me.
#### Tools
I have created tools within [Mix on Pix](https://apps.apple.com/us/app/mix-on-pix-text-on-photos/id633281586) to generate 70px x 70px png files for each shape drawn.  
I then used these images to train a model that is used in [Mix on Pix](https://apps.apple.com/us/app/mix-on-pix-text-on-photos/id633281586) Auto-Shapes feature.
#### Shape of type Other
The first ML model had no **Other** shape. I was initially happy with the excellent accuracy when the drawing corresponded to the intent. But when testing internally with [Mix on Pix](https://apps.apple.com/us/app/mix-on-pix-text-on-photos/id633281586), errors while drawing would lead to Ellipse, Rectangle and Triangle recognition. Not a fantastic user experience.    
Moreover, when attacking the more difficult problem of determining the vertices of a shape, I had to exclude the **Other** shapes.

### Notes
- When training for [Mix on Pix](https://apps.apple.com/us/app/mix-on-pix-text-on-photos/id633281586) using a GPU over 300 epochs, I get a validation accuracy around 0.9980
- Once the model is trained, I generate a TensorFlow Lite model that I then use in [Mix on Pix](https://apps.apple.com/us/app/mix-on-pix-text-on-photos/id633281586).


### To do
General
- Make a smaller dataset subset?
- Create nbviewer links for the notebooks?
- Describe the Obvious vs Interesting. Easy vs cases where a human can hardly decide between 2 shapes. Also Rotation.
  - Describe examples for a progression of difficulties.
- Create a DataSheet for the Dataset as described in https://arxiv.org/pdf/1803.09010.pdf  

Classification
- Rename variables like X_train

Later
- Show Saliency map after classification.
- Show model to calculate Vertices

---
by Francois Robert 

